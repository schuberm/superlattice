%
% This file may be distributed and/or modified under the terms of 
% the Do What The Fuck You Want To Public License, Version 2
% 

\ProvidesPackage{beamerthemeuoft}[2011/04/20]
\RequirePackage{tikz}
\RequirePackage{calc}

\RequirePackage[scriptsize,it]{caption}
\captionsetup{labelformat=empty,labelsep=none}

\providecommand\insertframetitle{} 

\mode<presentation>

%%% variables and options
\def\beamer@uoft@value@true{true}
\def\beamer@uoft@value@false{false}
\def\beamer@uoft@value@empty{}

\def\beamer@uoft@url{}
\def\beamer@uoft@numbering{}
\def\beamer@uoft@titlepagelayout{}

\newlength{\beamer@uoft@menuwidth}
\newlength{\beamer@uoft@restofmenuwidth}

\setlength{\beamer@uoft@menuwidth}{.3\paperwidth}

\DeclareOptionBeamer{url}[{www.utoronto.ca}]{\def\beamer@uoft@url{#1}}
\DeclareOptionBeamer{numbering}[true]{\def\beamer@uoft@numbering{#1}}
\DeclareOptionBeamer{titlepagelayout}[]{\def\beamer@uoft@titlepagelayout{#1}}
\DeclareOptionBeamer{menuwidth}[]{\setlength{\beamer@uoft@menuwidth}{#1}}


\ProcessOptionsBeamer

\setlength{\beamer@uoft@restofmenuwidth}{0.55\paperwidth}
\addtolength\beamer@uoft@restofmenuwidth{-\beamer@uoft@menuwidth}



\useinnertheme{circles}
\useoutertheme{miniframes}

\usecolortheme{uoft}

\setbeamertemplate{navigation symbols}{}

% TITLE PAGE
\defbeamertemplate*{title page}{titlepage}
{
  \thispagestyle{empty}

  \begin{picture}(0,0)(0,0)
    %\put(-29,-171){\includegraphics[width=1.01\paperwidth]{images/layout-1.pdf}}
  \end{picture}

  \begin{picture}(0,0)(0,0)
    \put(10,30){
        \begin{minipage}{0.9\linewidth}
        \centering{\LARGE\color{uoftwhite} \inserttitle\par}
        \centering{\large\color{uoftlightgrey} \insertsubtitle\par}
        \end{minipage}
    }
  \end{picture}
  \begin{picture}(0,0)(0,0)
    \put(10,-10){
        \begin{minipage}{0.90\linewidth}
        \centering{\large\color{uoftwhite} \insertauthor\par}
        \end{minipage}
    }
  \end{picture}
  \begin{picture}(0,0)(0,0)
    \put(10,-125){
        \begin{minipage}{0.90\linewidth}
        \centering{\color{uoftblack} \insertinstitute\par}
        \end{minipage}
    }
  \end{picture}

}

% HEADER
%\begin{comment}
\defbeamertemplate*{headline}{uoft}%
{
  \begin{beamercolorbox}[wd=\paperwidth,leftskip=1em,sep=0.3em]{headerline title}
    %\begin{minipage}{\beamer@uoft@restofmenuwidth} %{\beamer@uoft@frametitle}
        %{\tiny{\bfseries {\insertframetitle{}} }}%
    %\end{minipage}
    \large{\insertframetitle{}}
    %\hspace{2ex}\insertframetitle{} \hspace{1ex}\hrulefill 
    %\hspace{0px}
    %\begin{minipage}{\beamer@uoft@menuwidth}
      %\begin{flushright}
        %\insertsectionnavigationhorizontal{\beamer@uoft@menuwidth}{}{}
      %\end{flushright}
    %\end{minipage}
   
  \end{beamercolorbox}
  \begin{beamercolorbox}[wd=\paperwidth,sep=1px]{headerline border}
    %\vspace{1px}
  \end{beamercolorbox}
}
%\end{comment}

% FOOTER
%\begin{comment}
\defbeamertemplate*{footline}{uoft}
{
%\leavevmode%
  \begin{beamercolorbox}[wd=\paperwidth,leftskip=1em,sep=0.2em]{footerline}
    %\insertshorttitle\;--\;\insertshortauthor \hfill %
    \insertsectionhead \hfill%
    \ifx\beamer@uoft@numbering\beamer@uoft@value@false\relax\else
        \insertframenumber/\inserttotalframenumber\;%--\; %
    \fi
    %\ifx\beamer@uoft@url\beamer@uoft@value@empty
    %    {\bfseries www.utoronto.ca}
    %\else
    %    {\bfseries \beamer@uoft@url}
    %\fi
  \end{beamercolorbox}  
}
%\end{comment}

% SECTION LIST
\usesectionheadtemplate
{ %active
  \color{uoftred} \insertsectionhead
}
{ %other
  \color{uoftlightgrey} \insertsectionhead
}

% BACKGROUND IMAGE
\setbeamertemplate{background}{
  \ifnum\insertframenumber=1\else
  \parbox[r][\paperheight]{\paperwidth}{
    \vfill\hfill
    %\includegraphics[width=30px]{images/uoft-watermark.pdf}
  }
  \fi
}


\defbeamertemplate*{frametitle}{}
{
  \begin{beamercolorbox}[sep=0ex,ht= 2ex, wd=\paperwidth]{}
    %\hspace{2ex}\insertframetitle{} \hspace{1ex}\hrulefill %
  \end{beamercolorbox}%
}

%
\newcommand{\sectionframe}[1]
{
    \begin{beamercolorbox}[wd=\textwidth]{footerline}
        \begin{minipage}{\textwidth}
          \vspace{1em}
          \centering\Large{\color{white}{#1}}
          \vspace{1em}
        \end{minipage}%
    \end{beamercolorbox}%
    \nointerlineskip
    \begin{beamercolorbox}[sep=0ex,ht=2pt, wd=\textwidth]{headerline border}
    \end{beamercolorbox}%
}
%\mode<handout>

\mode
<all>
